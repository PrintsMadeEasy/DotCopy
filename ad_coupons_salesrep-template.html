<html>
<head>
<title>Sales Rep Coupon</title>
<link rel="stylesheet" href="./library/stylesheet.css" TYPE="text/css" />
<link rel="SHORTCUT ICON" href="/favicon.ico" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<script language="javascript">

	//Make an array of the images we want to preload for the mouse-overs.
	arImageSrc = new Array (
		"./images/button-go-d.gif",
		"./images/button-closewindow-blue-d.gif",
		"./images/button-sendmessage-blue-d.gif"
	)

	//Preload images.
	arImageList = new Array ();
	for (counter in arImageSrc) {
		arImageList[counter] = new Image();
		arImageList[counter].src = arImageSrc[counter];
	}


	function CheckCouponForm(){
		var EmailAddr = document.forms["couponfrm"].email.value;
		var PercentVal = document.forms["couponfrm"].discount.value;
		var UsageVal = document.forms["couponfrm"].usewithin.value;
		var CouponCode = document.forms["couponfrm"].code.value;
		var MaxAmount = document.forms["couponfrm"].maxamount.value;

		var ErrorMsg = "";

		if(EmailAddr.search(/^\w+([-.]\w+)*\@\w+([-.]\w+)*\.\w+$/) == -1)
			ErrorMsg += "The email address is not in proper format.\n\n"

		if(PercentVal.search(/^\d+(\.\d{1,3})?$/) == -1){
			ErrorMsg += "The Discount percent is not in proper format.\n\n";
		}
		else{
			if(parseFloat(PercentVal) > 100)
				ErrorMsg += "The Discount percent can not be greater than 100.\n\n";
		}
		
		if(MaxAmount.search(/(^\d+(\.\d{1,2})?)?$/) == -1)
			ErrorMsg += "The Max Amount is not in proper format.\n\n";


		if(UsageVal.search(/^\d*$/) == -1)
			ErrorMsg += "The Usage Limit is not in proper format.\n\n";

		if(CouponCode.search(/^[A-Za-z]+[\dA-Za-z\-]+$/) == -1)
			ErrorMsg += "* The Coupon Code must only contain letter and numbers and it must begin with a letter. (hyphens OK)\n";
		if(CouponCode.search(/^X/) != -1)
			ErrorMsg += "* The Coupon Code may not begin with X\n";

		if(ErrorMsg == ""){
			return true;
		}
		else{
			alert(ErrorMsg);
			return false;
		}
	}

</script>

</head>

<body bgcolor="#3366CC" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" onLoad="" >
<img  src="./images/transparent.gif" border="0" width="1" height="10" alt="" /><br/>
<div align="center">
<table bgcolor="#EEEEEE" width="590" cellpadding="0" cellspacing="0" border="0">

<tr>
<td bgcolor="#666666" class="Body" align="center"><img  src="./images/transparent.gif" border="0" width="1" height="3" alt="" /><br/><font color="#FFFFFF"><b>Quick-Add a Coupon For a Sales Rep</b></font><br/><img src="./images/transparent.gif" border="0" width="1" height="3" alt="" /></td>

<tr>
<td class="Body">&nbsp;
<!-- BEGIN MainFormBL -->
<font class="error">{ERROR}</font>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<form name="couponfrm" action="./ad_coupons_salesrep.php" onsubmit="return CheckCouponForm();">
<input type="hidden" name="form_sc" value="{FORM_SECURITY_CODE}" />
<input type="hidden" name="action" value="save" />
  <tr>
            <td class="ReallySmallBody" align="center">

			<table width="94%" border="0" cellspacing="5" cellpadding="3">
  <tr>
    <td class="SmallBody" bgcolor="#DDDDFF">Sales Rep's Email Address</td>
	<td class="SmallBody" bgcolor="#DDDDFF">Coupon Code</td>
    <td class="SmallBody" bgcolor="#DDDDFF">Coupon Discount</td>
	<td class="SmallBody" bgcolor="#DDDDFF">Max Amount</td>
    <td class="ReallySmallBody" bgcolor="#DDDDFF">Use Within First _ Order(s)</td>
  </tr>
   <tr>
    <td class="SmallBody"><input type="text" name="email" value="{EMAIL}" style="background-color:#FFFFFF; width:170; border-width:1; font-size:12px;" class="SmallInputBox" /></td>
     <td class="SmallBody"><input type="text" name="code" value="{CODE}" style="background-color:#FFFFFF; width:100; border-width:1; font-size:12px;" class="SmallInputBox" maxlength="20" /></td>
	<td class="SmallBody"><input type="text" name="discount" value="{DISC}" style="background-color:#FFFFFF; width:40; border-width:1; font-size:12px;" class="SmallInputBox" maxlength="3" />%</td>
	<td class="SmallBody">$<input type="text" name="maxamount" value="{MAX}" style="background-color:#FFFFFF; width:50; border-width:1; font-size:12px;" class="SmallInputBox" maxlength="6" /></td>
    <td class="SmallBody"><input type="text" name="usewithin" value="{USEWITHIN}" style="background-color:#FFFFFF; width:40; border-width:1; font-size:12px;" class="SmallInputBox" maxlength="3" /></td>
  </tr>
</table>
			</td>

  </tr>
    <tr>
            <td class="ReallySmallBody" align="right"><font color="#990000">*</font> For unlimited coupon usage or Max Amount, leave fields blank.<img src="./images/transparent.gif" border="0" width="150" height="3" alt="" /><input type="submit" name="xx" value="Add" class="AdminButton" onmouseover="this.style.background='#ffeeaa';" onmouseout="this.style.background='#FFFFDD';" /><img src="./images/transparent.gif" border="0" width="15" height="10" alt="" /></td>

  </tr>


 </form>
</table>
<!-- END MainFormBL -->
<!-- BEGIN SuccessBL -->
<br/><br/>The coupon has been successfully added.<br/><br/>
<script>
self.close();
</script>
<!-- END SuccessBL -->
 </td>
</tr>


<tr>
<td><img src="images/header-editoptions-fade-bot.gif" width="590" alt="" /></td>
</tr>
</table>

</div>


</body>
</html>
